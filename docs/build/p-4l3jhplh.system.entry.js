var __awaiter=this&&this.__awaiter||function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,s){function o(t){try{a(r.next(t))}catch(e){s(e)}}function u(t){try{a(r["throw"](t))}catch(e){s(e)}}function a(t){t.done?n(t.value):i(t.value).then(o,u)}a((r=r.apply(t,e||[])).next())}))};var __generator=this&&this.__generator||function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(t){return function(e){return a([t,e])}}function a(o){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(s=o[0]&2?i["return"]:o[0]?i["throw"]||((s=i["return"])&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;if(i=0,s)o=[o[0]&2,s.value];switch(o[0]){case 0:case 1:s=o;break;case 4:n.label++;return{value:o[1],done:false};case 5:n.label++;i=o[1];o=[0];continue;case 7:o=n.ops.pop();n.trys.pop();continue;default:if(!(s=n.trys,s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){n=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){n.label=o[1];break}if(o[0]===6&&n.label<s[1]){n.label=s[1];s=o;break}if(s&&n.label<s[2]){n.label=s[2];n.ops.push(o);break}if(s[2])n.ops.pop();n.trys.pop();continue}o=e.call(t,n)}catch(u){o=[6,u];i=0}finally{r=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}};var __spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var s=arguments[e],o=0,u=s.length;o<u;o++,i++)r[i]=s[o];return r};System.register(["./p-f35642a8.system.js"],(function(t){"use strict";var e,n,r,i;return{setters:[function(t){e=t.r;n=t.h;r=t.H;i=t.g}],execute:function(){var s=t("ct_actions",function(){function t(t){e(this,t)}t.prototype.render=function(){return n(r,null,n("div",{class:"ct-actions__emoji"},n("ct-button",{small:true},"+ Emoji")),n("div",{class:"ct-actions__controls"},n("a",null,"Reply"),n("span",null,"·"),n("a",null,"Share")))};Object.defineProperty(t,"style",{get:function(){return":host{display:block;margin-top:1rem}"},enumerable:true,configurable:true});return t}());var o=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function u(t,e){return e={exports:{}},t(e,e.exports),e.exports}var a=u((function(t){
/*!
                  Copyright (c) 2017 Jed Watson.
                  Licensed under the MIT License (MIT), see
                  http://jedwatson.github.io/classnames
                */
(function(){var e={}.hasOwnProperty;function n(){var t=[];for(var r=0;r<arguments.length;r++){var i=arguments[r];if(!i)continue;var s=typeof i;if(s==="string"||s==="number"){t.push(i)}else if(Array.isArray(i)&&i.length){var o=n.apply(null,i);if(o){t.push(o)}}else if(s==="object"){for(var u in i){if(e.call(i,u)&&i[u]){t.push(u)}}}}return t.join(" ")}if(t.exports){n.default=n;t.exports=n}else{window.classNames=n}})()}));var c=t("ct_avatar",function(){function t(t){e(this,t);this.nested=false}t.prototype.render=function(){return n("div",{class:a("ct-comment__avatar",{"ct-comment__avatar--nested":this.nested})},this.user?n("img",{src:this.user.picture_url,alt:this.user.name+"'s Avatar"}):n("img",{src:i("./assets/fallback.jpg"),alt:"No avatar"}))};Object.defineProperty(t,"assetsDirs",{get:function(){return["assets"]},enumerable:true,configurable:true});Object.defineProperty(t,"style",{get:function(){return":host{width:3.5rem;height:3.5rem}:host img{width:100%;height:100%;border-radius:50%}.ct-comment__avatar--nested{width:2.5rem;height:2.5rem}"},enumerable:true,configurable:true});return t}());var l=t("ct_button",function(){function t(t){e(this,t);this.small=false}t.prototype.render=function(){return n(r,{class:a("ct-button",{"ct-button--small":this.small})},n("slot",null))};Object.defineProperty(t,"style",{get:function(){return":host{display:-ms-inline-flexbox;display:inline-flex;padding:1rem 1.75rem;background-color:#0d2031;margin-top:1rem;color:#00d664;font-size:.875rem;cursor:pointer}:host.ct-button--small{padding:0}"},enumerable:true,configurable:true});return t}());var f=u((function(t,e){!function(e,n){t.exports=n()}(o,(function(){var t="millisecond",e="second",n="minute",r="hour",i="day",s="week",o="month",u="quarter",a="year",c=/^(\d{4})-?(\d{1,2})-?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d{1,3})?$/,l=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,f=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},h={s:f,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return(e<=0?"+":"-")+f(r,2,"0")+":"+f(i,2,"0")},m:function(t,e){var n=12*(e.year()-t.year())+(e.month()-t.month()),r=t.clone().add(n,o),i=e-r<0,s=t.clone().add(n+(i?-1:1),o);return Number(-(n+(e-r)/(i?r-s:s-r))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(c){return{M:o,y:a,w:s,d:i,h:r,m:n,s:e,ms:t,Q:u}[c]||String(c||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},d={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},m="en",p={};p[m]=d;var v=function(t){return t instanceof $},y=function(t,e,n){var r;if(!t)return m;if("string"==typeof t)p[t]&&(r=t),e&&(p[t]=e,r=t);else{var i=t.name;p[i]=t,r=i}return n||(m=r),r},g=function(t,e,n){if(v(t))return t.clone();var r=e?"string"==typeof e?{format:e,pl:n}:e:{};return r.date=t,new $(r)},b=h;b.l=y,b.i=v,b.w=function(t,e){return g(t,{locale:e.$L,utc:e.$u,$offset:e.$offset})};var $=function(){function f(t){this.$L=this.$L||y(t.locale,null,!0),this.parse(t)}var h=f.prototype;return h.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(b.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(c);if(r)return n?new Date(Date.UTC(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)):new Date(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)}return new Date(e)}(t),this.init()},h.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},h.$utils=function(){return b},h.isValid=function(){return!("Invalid Date"===this.$d.toString())},h.isSame=function(t,e){var n=g(t);return this.startOf(e)<=n&&n<=this.endOf(e)},h.isAfter=function(t,e){return g(t)<this.startOf(e)},h.isBefore=function(t,e){return this.endOf(e)<g(t)},h.$g=function(t,e,n){return b.u(t)?this[e]:this.set(n,t)},h.year=function(t){return this.$g(t,"$y",a)},h.month=function(t){return this.$g(t,"$M",o)},h.day=function(t){return this.$g(t,"$W",i)},h.date=function(t){return this.$g(t,"$D","date")},h.hour=function(t){return this.$g(t,"$H",r)},h.minute=function(t){return this.$g(t,"$m",n)},h.second=function(t){return this.$g(t,"$s",e)},h.millisecond=function(e){return this.$g(e,"$ms",t)},h.unix=function(){return Math.floor(this.valueOf()/1e3)},h.valueOf=function(){return this.$d.getTime()},h.startOf=function(t,u){var c=this,l=!!b.u(u)||u,f=b.p(t),h=function(t,e){var n=b.w(c.$u?Date.UTC(c.$y,e,t):new Date(c.$y,e,t),c);return l?n:n.endOf(i)},d=function(t,e){return b.w(c.toDate()[t].apply(c.toDate(),(l?[0,0,0,0]:[23,59,59,999]).slice(e)),c)},m=this.$W,p=this.$M,v=this.$D,y="set"+(this.$u?"UTC":"");switch(f){case a:return l?h(1,0):h(31,11);case o:return l?h(1,p):h(0,p+1);case s:var g=this.$locale().weekStart||0,$=(m<g?m+7:m)-g;return h(l?v-$:v+(6-$),p);case i:case"date":return d(y+"Hours",0);case r:return d(y+"Minutes",1);case n:return d(y+"Seconds",2);case e:return d(y+"Milliseconds",3);default:return this.clone()}},h.endOf=function(t){return this.startOf(t,!1)},h.$set=function(s,u){var c,l=b.p(s),f="set"+(this.$u?"UTC":""),h=(c={},c[i]=f+"Date",c.date=f+"Date",c[o]=f+"Month",c[a]=f+"FullYear",c[r]=f+"Hours",c[n]=f+"Minutes",c[e]=f+"Seconds",c[t]=f+"Milliseconds",c)[l],d=l===i?this.$D+(u-this.$W):u;if(l===o||l===a){var m=this.clone().set("date",1);m.$d[h](d),m.init(),this.$d=m.set("date",Math.min(this.$D,m.daysInMonth())).toDate()}else h&&this.$d[h](d);return this.init(),this},h.set=function(t,e){return this.clone().$set(t,e)},h.get=function(t){return this[b.p(t)]()},h.add=function(t,u){var c,l=this;t=Number(t);var f=b.p(u),h=function(e){var n=g(l);return b.w(n.date(n.date()+Math.round(e*t)),l)};if(f===o)return this.set(o,this.$M+t);if(f===a)return this.set(a,this.$y+t);if(f===i)return h(1);if(f===s)return h(7);var d=(c={},c[n]=6e4,c[r]=36e5,c[e]=1e3,c)[f]||1,m=this.$d.getTime()+t*d;return b.w(m,this)},h.subtract=function(t,e){return this.add(-1*t,e)},h.format=function(t){var e=this;if(!this.isValid())return"Invalid Date";var n=t||"YYYY-MM-DDTHH:mm:ssZ",r=b.z(this),i=this.$locale(),s=this.$H,o=this.$m,u=this.$M,a=i.weekdays,c=i.months,f=function(t,r,i,s){return t&&(t[r]||t(e,n))||i[r].substr(0,s)},h=function(t){return b.s(s%12||12,t,"0")},d=i.meridiem||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r},m={YY:String(this.$y).slice(-2),YYYY:this.$y,M:u+1,MM:b.s(u+1,2,"0"),MMM:f(i.monthsShort,u,c,3),MMMM:c[u]||c(this,n),D:this.$D,DD:b.s(this.$D,2,"0"),d:String(this.$W),dd:f(i.weekdaysMin,this.$W,a,2),ddd:f(i.weekdaysShort,this.$W,a,3),dddd:a[this.$W],H:String(s),HH:b.s(s,2,"0"),h:h(1),hh:h(2),a:d(s,o,!0),A:d(s,o,!1),m:String(o),mm:b.s(o,2,"0"),s:String(this.$s),ss:b.s(this.$s,2,"0"),SSS:b.s(this.$ms,3,"0"),Z:r};return n.replace(l,(function(t,e){return e||m[t]||r.replace(":","")}))},h.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},h.diff=function(t,c,l){var f,h=b.p(c),d=g(t),m=6e4*(d.utcOffset()-this.utcOffset()),p=this-d,v=b.m(this,d);return v=(f={},f[a]=v/12,f[o]=v,f[u]=v/3,f[s]=(p-m)/6048e5,f[i]=(p-m)/864e5,f[r]=p/36e5,f[n]=p/6e4,f[e]=p/1e3,f)[h]||p,l?v:b.a(v)},h.daysInMonth=function(){return this.endOf(o).$D},h.$locale=function(){return p[this.$L]},h.locale=function(t,e){if(!t)return this.$L;var n=this.clone();return n.$L=y(t,e,!0),n},h.clone=function(){return b.w(this.$d,this)},h.toDate=function(){return new Date(this.valueOf())},h.toJSON=function(){return this.isValid()?this.toISOString():null},h.toISOString=function(){return this.$d.toISOString()},h.toString=function(){return this.$d.toUTCString()},f}();return g.prototype=$.prototype,g.extend=function(t,e){return t(e,$,g),g},g.locale=y,g.isDayjs=v,g.unix=function(t){return g(1e3*t)},g.en=p[m],g.Ls=p,g}))}));var h=u((function(t,e){!function(e,n){t.exports=n()}(o,(function(){return function(t,e,n){var r=e.prototype;n.en.relativeTime={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};var i=function(t,e,r,i){for(var s,o,u=r.$locale().relativeTime,a=[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],c=a.length,l=0;l<c;l+=1){var f=a[l];f.d&&(s=i?n(t).diff(r,f.d,!0):r.diff(t,f.d,!0));var h=Math.round(Math.abs(s));if(h<=f.r||!f.r){1===h&&l>0&&(f=a[l-1]),o=u[f.l].replace("%d",h);break}}return e?o:(s>0?u.future:u.past).replace("%s",o)};r.to=function(t,e){return i(t,e,this,!0)},r.from=function(t,e){return i(t,e,this)};var s=function(t){return t.$u?n.utc():n()};r.toNow=function(t){return this.to(s(this),t)},r.fromNow=function(t){return this.from(s(this),t)}}}))}));f.extend(h);var d=t("ct_comment",function(){function t(t){e(this,t);this.nested=false;this.areRepliesVisible=false;this.isDeleted=!(this.comment.user&&this.comment.user.name.length);this.hasReplies=this.comment.replies.length>0}t.prototype.toggleReplies=function(){this.areRepliesVisible=!this.areRepliesVisible};t.prototype.getUserName=function(){if(this.isDeleted){return"Comment deleted"}return this.comment.user&&this.comment.user.name};t.prototype.getDate=function(){return this.comment&&f(this.comment.created_at)};t.prototype.getCreatedFromNowDate=function(){return this.getDate().fromNow()};t.prototype.getFullDate=function(){return this.getDate().toString()};t.prototype.render=function(){var t=this;console.log(this.comment);return n(r,null,n("div",{class:"ct-comment"},n("ct-avatar",{user:this.comment.user,nested:this.nested}),n("div",{class:a("ct-comment__content",{"ct-comment__content--nested":this.nested})},n("div",{class:"content-meta"},n("div",{class:a("name",{"name--deleted":this.isDeleted})},this.getUserName()),n("div",{class:"separator"},"·"),n("div",{class:"date"},n("abbr",{title:this.getFullDate()},this.getCreatedFromNowDate()))),n("div",{class:"content-body"},this.comment.body),n("ct-actions",null),this.hasReplies&&!this.nested&&n("ct-button",{onClick:function(){return t.toggleReplies()}},"Show replies"))),n("div",{class:a("ct-replies",{"ct-replies--visible":this.nested||this.areRepliesVisible})},this.comment.replies.map((function(t,e){return n("ct-comment",{comment:t,nested:true})}))))};Object.defineProperty(t,"style",{get:function(){return":host{display:block}abbr{text-decoration:none}.ct-comment{display:-ms-flexbox;display:flex;min-height:5.5rem;padding:1rem}.ct-comment__content{margin-left:1rem}.ct-comment__content--nested{margin-left:.25rem}.ct-comment__content .content-meta{display:-ms-flexbox;display:flex;font-size:.875rem}.ct-comment__content .content-meta .name{font-weight:700;color:#00d664;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ct-comment__content .content-meta .name.name--deleted{color:#fff}.ct-comment__content .content-meta .date,.ct-comment__content .content-meta .separator{margin-left:.5rem}.ct-comment__content .content-body{margin-top:.75rem;font-size:1rem}.ct-replies{margin-left:1.75rem;position:relative;display:none}.ct-replies--visible{display:block}"},enumerable:true,configurable:true});return t}());var m=function(t,e){var n=new Map;var r=t;var i=function(t,e){if(Array.isArray(t)){__spreadArrays(t).forEach((function(t){e[t]=r[t]}))}else{e[t]=Object.assign({},r)}};var s=function(t,e){if(!n.has(t)){n.set(t,e);i(e,t)}return function(){if(n.has(t)){n.delete(t)}}};var o=function(t,e){var s=t.state;r=s;n.forEach(i);return e};var u=function(t,n){return e(s,n[0])};var a=function(t,e){var r=t.prototype;var i=r.connectedCallback;var o=r.disconnectedCallback;r.connectedCallback=function(){s(this,e);if(i){return i.call(this)}};r.disconnectedCallback=function(){n.delete(this);if(o){o.call(this)}}};return{Provider:o,Consumer:u,injectProps:a}};var p=m({currentUser:{id:null,auth_token:null,email:null,name:null,picture_url:null},comments:[]},(function(t,e){return n("context-consumer",{subscribe:t,renderer:e})}));var v={auth:"auth",commentsList:function(t){return"/commentable/"+t+"/comments/list"}};var y={fetch:function(t,e){return __awaiter(this,void 0,void 0,(function(){var n;return __generator(this,(function(r){switch(r.label){case 0:return[4,fetch(t,Object.assign(Object.assign({},e),{headers:{"Content-Type":"application/json"}}))];case 1:n=r.sent();return[2,n.json()]}}))}))},auth:function(t,e){if(!e)return;return this.fetch(t+"/"+v.auth,{method:"post",body:JSON.stringify({id_token:e})})},fetchComments:function(t,e,n){return this.fetch(t+"/"+v.commentsList(e),{method:"post",body:JSON.stringify(n)})}};var g=t("ct_commentable",function(){function t(t){var n=this;e(this,t);this.currentUser={};this.comments=[];this.isLoading=true;this.setCurrentUser=function(t){n.currentUser=t};this.setComments=function(t){n.comments=t}}t.prototype.tokenWatchHandler=function(t){return __awaiter(this,void 0,void 0,(function(){var e;return __generator(this,(function(n){switch(n.label){case 0:return[4,y.auth(this.apiUrl,t)];case 1:e=n.sent();this.setCurrentUser(e);return[2]}}))}))};t.prototype.currentUserWatchHandler=function(){return __awaiter(this,void 0,void 0,(function(){var t,e;return __generator(this,(function(n){switch(n.label){case 0:t={};if(this.currentUser){t.auth_token=this.currentUser.auth_token}return[4,y.fetchComments(this.apiUrl,this.commentableId,t)];case 1:e=n.sent().comments;this.setComments(e.reverse());this.isLoading=false;return[2]}}))}))};t.prototype.render=function(){var t={currentUser:this.currentUser,comments:this.comments};return n(p.Provider,{state:t},this.isLoading?n("p",null,"Loading"):this.comments.map((function(t,e){return n("ct-comment",{comment:t})})))};Object.defineProperty(t,"watchers",{get:function(){return{googleIdToken:["tokenWatchHandler"],currentUser:["currentUserWatchHandler"]}},enumerable:true,configurable:true});Object.defineProperty(t,"style",{get:function(){return"\@import url(\"https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap\");:host{display:block;max-width:48rem;font-family:Open Sans,sans-serif;background-color:#0a1826;color:#f6f6f6}"},enumerable:true,configurable:true});return t}())}}}));